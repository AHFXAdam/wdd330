var r=(l,t,n)=>new Promise((s,e)=>{var m=i=>{try{a(n.next(i))}catch(o){e(o)}},c=i=>{try{a(n.throw(i))}catch(o){e(o)}},a=i=>i.done?s(i.value):Promise.resolve(i.value).then(m,c);a((n=n.apply(l,t)).next())});import u from"./externalServices.js";import{alertMessage as p,removeAllAlerts as h}from"./utils.js";export default class d{constructor(t){this.mainElement=document.querySelector(t),this.token=null,this.services=new u}login(t,n){return r(this,null,function*(){try{const s=yield this.services.loginRequest(t);this.token=s,n&&n()}catch(s){h(),p("Invalid Email/Password. Please Try again")}})}showLogin(){const t=document.createElement("form"),n=document.querySelector("main");t.innerHTML=`<label for='email'>Email</label><input type='text' name='email' id='email' value='user1@email.com'>
        <label for='password'>Password</label><input type='password' value='user1' name='password' id='password'>
        <input type='submit' value='Login'>
        `,t.addEventListener("submit",s=>{s.preventDefault();const e={email:document.querySelector("#email").value,password:document.querySelector("#password").value};this.login(e,this.showOrders.bind(this))}),n.appendChild(t)}showOrders(){return r(this,null,function*(){const t=yield this.services.getOrders(this.token);console.log(t[0].items);const n=document.createElement("table"),s=document.querySelector("main");n.innerHTML=t.map(e=>e.id!=null&&e.orderDate!=null&&e.items!=null&&e.orderTotal!=null?`<tr><td>${e.id}</td><td>${new Date(e.orderDate).toLocaleDateString("en-US")}</td><td>${e.items.length}</td><td>${e.orderTotal}</td></tr>`:"").join(""),s.appendChild(n)})}}const w=new d;w.showLogin();
