var n=(c,e,t)=>new Promise((r,o)=>{var d=a=>{try{i(t.next(a))}catch(s){o(s)}},u=a=>{try{i(t.throw(a))}catch(s){o(s)}},i=a=>a.done?r(a.value):Promise.resolve(a.value).then(d,u);i((t=t.apply(c,e)).next())});import"../web_modules/prettier.js";import{renderList as g,getLocalStorage as l,setLocalStorage as h}from"./utils.js";export default class m{constructor(e,t,r){this.dataSource=e,this.targetElement=t,this.category=r}init(){return n(this,null,function*(){this.showList(),this.updateHeading(this.category),document.querySelector("#sort").addEventListener("click",e=>this.sortAndShow()),this.updateSortDropdown()})}updateSortDropdown(){try{const e=l("sorting");document.querySelector("#sorting").value=e}catch(e){console.log("Couldn't find sorting")}}sortAndShow(){this.setSorting(document.querySelector("#sorting").value),this.showList()}showList(){return n(this,null,function*(){let e=yield this.dataSource.getData(this.category);e=this.sortList(e);const t=document.getElementById("product-card-template");this.targetElement.innerHTML="",g(t,this.targetElement,e,this.prepareTemplate)})}sortList(e){console.log(e);const t=l("sorting");switch(t){case"price":console.log("Sort by Price"),e.sort((r,o)=>r.FinalPrice>o.FinalPrice?1:-1);break;case"alpha":console.log("Sort by Alpha"),e.sort((r,o)=>r.NameWithoutBrand>o.NameWithoutBrand?1:-1);break;case"pricedesc":console.log("Sort by Price"),e.sort((r,o)=>r.FinalPrice<o.FinalPrice?1:-1);break;case"alphadesc":console.log("Sort by Alpha"),e.sort((r,o)=>r.NameWithoutBrand<o.NameWithoutBrand?1:-1);break;default:console.log("Sort by Default");break}return e}setSorting(e){h("sorting",e),console.log(e)}updateHeading(e){document.querySelector(".products>div>h2").innerHTML+=` ${e[0].toUpperCase()}${e.slice(1).replace("-"," ")}`}filterList(e){const t=["985RF","880RR","985PR","344YJ"],r=e.filter(o=>t.includes(o.Id));return r}prepareTemplate(e,t){return e.querySelector("a").href+=t.Id,e.querySelector("img").src=t.Images.PrimaryLarge,e.querySelector("img").alt+=t.Name,e.querySelector(".card__brand").innerHTML=t.Brand.Name,e.querySelector(".card__name").innerHTML=t.NameWithoutBrand,e.querySelector(".product-card__price").innerHTML+=t.ListPrice.toFixed(2),e.querySelector(".product-card__discount_price").innerHTML+=(t.SuggestedRetailPrice-t.ListPrice).toFixed(2),e}}
