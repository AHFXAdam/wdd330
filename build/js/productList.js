var n=(c,e,t)=>new Promise((r,a)=>{var u=i=>{try{s(t.next(i))}catch(o){a(o)}},h=i=>{try{s(t.throw(i))}catch(o){a(o)}},s=i=>i.done?r(i.value):Promise.resolve(i.value).then(u,h);s((t=t.apply(c,e)).next())});import{renderList as l,getLocalStorage as d,setLocalStorage as g}from"./utils.js";export default class m{constructor(e,t,r){this.dataSource=e,this.targetElement=t,this.category=r}init(){return n(this,null,function*(){this.showList(),this.updateHeading(this.category),document.querySelector("#sort").addEventListener("click",e=>this.sortAndShow()),this.updateSortDropdown()})}updateSortDropdown(){try{const e=d("sorting");document.querySelector("#sorting").value=e}catch(e){}}sortAndShow(){this.setSorting(document.querySelector("#sorting").value),this.showList()}showList(){return n(this,null,function*(){let e=yield this.dataSource.getData(this.category);e=this.sortList(e);const t=document.getElementById("product-card-template");this.targetElement.innerHTML="",l(t,this.targetElement,e,this.prepareTemplate)})}sortList(e){const t=d("sorting");switch(t){case"price":e.sort((r,a)=>r.FinalPrice>a.FinalPrice?1:-1);break;case"alpha":e.sort((r,a)=>r.NameWithoutBrand>a.NameWithoutBrand?1:-1);break;case"pricedesc":e.sort((r,a)=>r.FinalPrice<a.FinalPrice?1:-1);break;case"alphadesc":e.sort((r,a)=>r.NameWithoutBrand<a.NameWithoutBrand?1:-1);break;default:break}return e}setSorting(e){g("sorting",e)}updateHeading(e){document.querySelector(".products>div>h2").innerHTML+=` ${e[0].toUpperCase()}${e.slice(1).replace("-"," ")}`}filterList(e){const t=["985RF","880RR","985PR","344YJ"],r=e.filter(a=>t.includes(a.Id));return r}prepareTemplate(e,t){return e.querySelector("a").href+=t.Id,e.querySelector("img").src=t.Images.PrimaryLarge,e.querySelector("img").alt+=t.Name,e.querySelector(".card__brand").innerHTML=t.Brand.Name,e.querySelector(".card__name").innerHTML=t.NameWithoutBrand,e.querySelector(".product-card__price").innerHTML+=t.ListPrice.toFixed(2),e.querySelector(".product-card__discount_price").innerHTML+=(t.SuggestedRetailPrice-t.ListPrice).toFixed(2),e}}
